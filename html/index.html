<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/connexion.css">
    <title>connexion</title>
    <script>
        function afficher(){
            var data =document.getElementById("message").value;
            alert(data);
        }

        function sendData(data) {

            var XHR = new XMLHttpRequest();
            var urlEncodedData = "";
            var urlEncodedDataPairs = [];
            var name;

            // Transformez l'objet data en un tableau de paires clé/valeur codées URL.
            for(name in data) {
                urlEncodedDataPairs.push(encodeURIComponent(name) + '=' + encodeURIComponent(data[name]));
            }

            // Combinez les paires en une seule chaîne de caractères et remplacez tous
            // les espaces codés en % par le caractère'+' ; cela correspond au comportement
            // des soumissions de formulaires de navigateur.
            urlEncodedData = urlEncodedDataPairs.join('&').replace(/%20/g, '+');

            // Définissez ce qui se passe en cas de succès de soumission de données
            XHR.addEventListener('load', function(event) {
                alert('Ouais ! Données envoyées et réponse chargée.');
            });

            // Définissez ce qui arrive en cas d'erreur
            XHR.addEventListener('error', function(event) {
                alert('Oups! Quelque chose s\'est mal passé.');
            });

            // Configurez la requête
            XHR.open('POST', 'ws://127.0.0.1:1000');

            // Ajoutez l'en-tête HTTP requise pour requêtes POST de données de formulaire
            XHR.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');

            // Finalement, envoyez les données.
            XHR.send(urlEncodedData);
        }
        
    </script>
</head>
<body>
    <div id="container">
        <!-- 
        <form action="verification.php" method="POST">
            <h1>Connexion</h1>
            
            <label><b>Nom de compte</b></label>
            <input type="text" placeholder="Entrer le nom de compte" name="username" required>

            <label><b>Mot de passe</b></label>
            <input type="password" placeholder="Entrer le mot de passe" name="password" required>

            <input type="submit" id='submit' value='Connexion' >
            <a class="lien" href="inscription.html">inscrivez-vous ici </a>
           
        </form>
    </div>
-->
    <div>

        <h3>Envoyer un message</h3>

        <form action="" method="POST">

            <input type="text" id="message"  value="" size="30" required>
            <input type="button" id="bouton" value="Afficher" size="30" onclick="afficher()">

            <button type="button" onclick="sendData({test:'ok'})">Cliquez ici !</button>
    
        </form>
    </div>
    <script type="text/javascript" src="senddata.js"></script>
    <script type="text/javascript" src="receivedata.js"></script>
</body>
</html>